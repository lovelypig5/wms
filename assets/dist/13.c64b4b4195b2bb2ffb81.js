webpackJsonp([13,17],{DLZF:function(t,a,e){"use strict";(function(t,i){function d(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(a,"__esModule",{value:!0});var o=e("yjFh"),r=d(o),s=e("LJdO"),l=d(s),n=e("k06x"),c=d(n),f=e("UY0x"),h=d(f),u=t.extend({template:l.default,name:"goodList",data:function(){return{attrlist:[],good:{name:"",list:[]},loading:{fetch:!1,add:!1},filters:[]}},ready:function(){this.fetch(!0),this.fetchAttrList(),i(this.$el).on("click",".save",this.addAttr),i(".add-attr").popover({content:function(){return'<input type="text" placeholder="请输入属性名称" class="attrName"/><button class="btn-primary save">保存</button>'},html:!0})},computed:{filteredList:function(){var t=this;if(!this.filters.length)return this.good.list;var a=[];return this.good.list.forEach(function(e){var i=[];t.filters.length<=e.attrs.length&&e.attrs.forEach(function(t){i.push(t.attr)});var d=!0;t.filters.forEach(function(t){if(i.indexOf(t)==-1)return void(d=!1)}),d&&a.push(e)}),a}},methods:{addAttr:function(){var t=this,a=i(this.$el).find(".attrName").val();a&&a.trim()&&(t.loading.add||(t.loading.add=!t.loading.add,i.ajax({url:c.default.addAttr,type:"post",data:(0,r.default)({attr:a,goods_id:this.good.id}),success:function(e){t.alert({show:!0,msg:"添加成功",type:"success"}),t.attrlist.push({attr:a}),i(t.$el).find(".attrName").val(""),i(".add-attr").popover("hide")},error:function(a){t.alert({show:!0,msg:a.responseText||"添加商品属性失败",type:"error"})}}).always(function(){t.loading.add=!t.loading.add})))},fetch:function(t){var a=this;a.loading.fetch||(a.loading.fetch=!a.loading.fetch,i.ajax({url:c.default.goodsDetail,data:{id:this.$route.params.id},success:function(t){a.good=t},error:function(t){a.alert({show:!0,msg:"获取商品详情失败",type:"error"})}}).always(function(){a.loading.fetch=!a.loading.fetch}))},fetchAttrList:function(t){var a=this;i.ajax({url:c.default.goodsAttrs,data:{good_id:this.$route.params.id},success:function(e){a.attrlist=e,t&&"function"==typeof t&&t()},error:function(){a.attrlist=[]}})},filter:function(t){this.filters.indexOf(t)==-1?this.filters.push(t):this.filters.splice(t)},removeFilter:function(t){this.filters.indexOf(t)!=-1&&this.filters.splice(t)}},vuex:{actions:{alert:h.default.alert}}});a.default=u}).call(a,e("I3G/"),e("7t+N"))},LJdO:function(t,a){t.exports='<div> <div class=row> <div class=col-lg-12> <h1 class=page-header>{{good.name}}</h1> </div> </div> <div class=row> <div class=col-lg-12> <div class="panel panel-primary good-detail"> <div class=panel-heading> <i class="fa fa-bar-chart-o fa-fw"></i> {{good.name}} </div> <div class=panel-body> <div class=row> <div class=col-lg-12> <div class=table-responsive> <div class=attList> <table class=table> <thead> <tr> <th>属性列表<span class=add-attr data-container=.good-detail data-toggle=popover data-placement=bottom>+</span></th> </tr> </thead> <tbody> <tr> <td> <span v-for="attr in attrlist" class=attr @click=filter(attr.attr)>{{attr.attr}}</span> </td> </tr> </tbody> </table> </div> <div v-if="filters.length > 0"> <table class=table> <thead> <tr> <th>已选过滤条件 (点击下方已选条件取消选择)</th> </tr> </thead> <tbody> <tr> <td> <span v-for="attr in filters" class=attr @click=removeFilter(attr)>{{attr}}</span> </td> </tr> </tbody> </table> </div> <table class="table table-bordered table-hover table-striped" v-if=!loading.fetch> <thead> <tr> <th>库存列表</th> <th>库存数量</th> <th>操作</th> <th>趋势</th> </tr> </thead> <tbody> <tr class=item> <td>所有</td> <td>{{good.total}}</td> <td> </td> <td> <a href=javascript:void(0) v-link="{path: \'/goods/analysis\'}">趋势</a> </td> </tr> <tr class=item v-for="g in filteredList"> <td>{{g.attrs | join-attrs}}</td> <td>{{g.count}}</td> <td> <a href=javascript:void(0) v-link="{path: \'/goods/in\', query: {id: good.id, name: good.name, attr: g.attr} }">入库</a> <a href=javascript:void(0) v-link="{path: \'/goods/out\', query: {id: good.id, name: good.name, attr: g.attr} }">出库</a> </td> <td> <a href=javascript:void(0) v-link="{path: \'/goods/analysis\'}">趋势</a> </td> </tr> </tbody> </table> <div v-if=loading.fetch> <div class="loading audio-wave"></div> </div> </div> </div> </div> </div> </div> </div> </div> </div> '},YqVz:function(t,a,e){var i,d,o={};i=e("DLZF"),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default);var r="function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports;d&&(r.template=d),r.computed||(r.computed={}),Object.keys(o).forEach(function(t){var a=o[t];r.computed[t]=function(){return a}})}});
//# sourceMappingURL=13.c64b4b4195b2bb2ffb81.js.map