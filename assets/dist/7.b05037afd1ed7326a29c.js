webpackJsonp([7],{68:function(module,exports){eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar dict = {\n    goodsMenu: ['text_goods_state', 'text_goods_list', 'text_goods_out', 'text_goods_in', 'text_goods_outlist', 'text_goods_inlist', 'text_goods_create'],\n    orderMenu: ['text_order_list', 'text_order_create'],\n    select2: {\n        \"zh\": {\n            errorLoading: function errorLoading() {\n                return '无法载入结果。';\n            },\n            inputTooLong: function inputTooLong(args) {\n                var overChars = args.input.length - args.maximum;\n\n                var message = '请删除' + overChars + '个字符';\n\n                return message;\n            },\n            inputTooShort: function inputTooShort(args) {\n                var remainingChars = args.minimum - args.input.length;\n\n                var message = '请再输入至少' + remainingChars + '个字符';\n\n                return message;\n            },\n            loadingMore: function loadingMore() {\n                return '载入更多结果…';\n            },\n            maximumSelected: function maximumSelected(args) {\n                var message = '最多只能选择' + args.maximum + '个项目';\n\n                return message;\n            },\n            noResults: function noResults() {\n                return '未找到结果';\n            },\n            searching: function searching() {\n                return '搜索中…';\n            }\n        }\n    }\n};\n\nexports.default = dict;\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/config/dict.js\n ** module id = 68\n ** module chunks = 2 3 7 8 13 15\n **/\n//# sourceURL=webpack:///./js/config/dict.js?")},246:function(module,exports,__webpack_require__){eval('var __vue_script__, __vue_template__\n__vue_script__ = __webpack_require__(247)\n__vue_template__ = __webpack_require__(248)\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === "function" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/features/goods/in.vue\n ** module id = 246\n ** module chunks = 7\n **/\n//# sourceURL=webpack:///./js/features/goods/in.vue?')},247:function(module,exports,__webpack_require__){eval('/* WEBPACK VAR INJECTION */(function(Vue, $) {\'use strict\';\n\nObject.defineProperty(exports, "__esModule", {\n    value: true\n});\n\nvar _stringify = __webpack_require__(240);\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _api = __webpack_require__(64);\n\nvar _api2 = _interopRequireDefault(_api);\n\nvar _dict = __webpack_require__(68);\n\nvar _dict2 = _interopRequireDefault(_dict);\n\nvar _actions = __webpack_require__(61);\n\nvar _actions2 = _interopRequireDefault(_actions);\n\n__webpack_require__(16);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// <template>\n//     <div class="panel panel-primary good-in">\n//         <div class="panel-heading">商品入库</div>\n//         <div class="panel-body">\n//             <validator name="v">\n//                 <div class="input-group">\n//                     <span class="input-group-addon">商品名称</span>\n//                     <div class="select2Div">\n//                         <select id="productName" style="width: 100%" v-model="model.id" v-validate:name="{required:true}">\n//                         </select>\n//                     </div>\n//                 </div>\n//                 <div class="input-group error-msg" v-if="$v.name.touched && $v.name.invalid">\n//                     <div v-if="$v.name.required" class="red-color">商品名称不能为空</div>\n//                 </div>\n//                 <div class="input-group">\n//                     <span class="input-group-addon">商品属性</span>\n//                     <div class="select2Div">\n//                         <select id="productAttr" style="width: 100%">\n//                             <option v-for="attr in attrList" :value="attr.attr">{{attr.attr}}</option>\n//                         </select>\n//                     </div>\n//                 </div>\n//                 <div class="input-group">\n//                     <span class="input-group-addon">入库数量</span>\n//                     <input id="productAmount" type="text" class="form-control" placeholder="请输入入库数量" aria-describedby="productAmount" v-model="model.amount" v-validate:amount="{required:true, posInt: true}" :class="{\'red-border\': $v.amount && $v.amount.touched && $v.amount.invalid}" number>\n//                 </div>\n//                 <div class="input-group error-msg" v-if="$v.amount.touched && $v.amount.invalid">\n//                     <div v-if="$v.amount.required" class="red-color">入库数量不能为空</div>\n//                     <div v-if="!$v.amount.required && $v.amount.posInt" class="red-color">入库数量只能为正整数</div>\n//                 </div>\n//                 <div class="input-group">\n//                     <span class="input-group-addon" id="productAmount">商品进价</span>\n//                     <input type="text" class="form-control" placeholder="请输入商品进价" aria-describedby="productPriceIn" v-model="model.priceIn" v-validate:price="{required:true, number: true}" :class="{\'red-border\': $v.price && $v.price.touched && $v.price.invalid}">\n//                 </div>\n//                 <div class="input-group error-msg" v-if="$v.price.touched && $v.price.invalid">\n//                     <div v-if="$v.price.required" class="red-color">商品进价不能为空</div>\n//                     <div v-if="!$v.price.required && $v.price.number" class="red-color">商品进价只能为数字</div>\n//                 </div>\n//                 <div class="float-right btns">\n//                     <button type="button" class="btn btn-primary" @click="goodsIn">入库</button>\n//                     <button type="button" class="btn btn-danger" @click="reset">取消</button>\n//                 </div>\n//             </validator>\n//         </div>\n//     </div>\n// </template>\n// <script>\n\n\nvar GoodIn = Vue.extend({\n    name: \'in\',\n    data: function data() {\n        return {\n            model: {\n                id: "",\n                name: "",\n                attr: [],\n                amount: 0,\n                priceIn: ""\n            },\n            attrList: [],\n            loading: { in: false\n            }\n        };\n    },\n    ready: function ready() {\n        var self = this;\n        $(this.$el).find(\'#productName\').select2({\n            placeholder: "请输入商品名称（必填）",\n            language: _dict2.default.select2[this.lang],\n            ajax: {\n                url: _api2.default.searchGood,\n                data: function data(params) {\n                    return {\n                        name: params.term,\n                        page: params.page\n                    };\n                },\n\n                dataType: \'json\',\n                delay: 700,\n                processResults: function processResults(resp, params) {\n                    var ret = [];\n                    resp.forEach(function (r) {\n                        ret.push({\n                            id: r.id,\n                            text: r.name\n                        });\n                    });\n\n                    return {\n                        results: ret\n                    };\n                }\n            }\n        }).on(\'select2:select\', function (event) {\n            var data = event.params.data;\n            if (data) {\n                self.model.id = data.id;\n                self.model.name = data.text;\n                self.fetchAttrs();\n            }\n        });\n        $(this.$el).find(\'#productAttr\').select2({\n            multiple: true,\n            placeholder: "请选择商品属性",\n            language: _dict2.default.select2[this.lang]\n        });\n\n        this.$watch(\'model.id\', this.changeSelect);\n        this.init();\n    },\n\n    watch: {\n        attrList: function attrList() {\n            $(this.$el).find(\'#productAttr\').trigger(\'change\');\n        }\n    },\n    methods: {\n        init: function init() {\n            var self = this;\n            var id = self.$route.query.id;\n            var name = self.$route.query.name;\n\n            if (id && name) {\n                self.model.id = id;\n                self.model.name = decodeURIComponent(name);\n                $(self.$el).find(\'#productName\').append(\'<option value="\' + self.model.id + \'">\' + self.model.name + \'</option>\');\n                self.fetchAttrs(function () {\n                    var attr = self.$route.query.attr;\n                    attr = decodeURIComponent(attr).split(\',\');\n                    if (attr) {\n                        Vue.nextTick(function () {\n                            self.model.attr = attr;\n                            $("#productAttr").val(attr).trigger(\'change\');\n                        });\n                    }\n                });\n            }\n        },\n        changeSelect: function changeSelect() {\n            $(this.$el).find(\'#productName\').trigger(\'change\');\n        },\n        fetchAttrs: function fetchAttrs(callback) {\n            var self = this;\n            $.ajax({\n                url: _api2.default.goodsAttrs,\n                data: {\n                    good_id: this.model.id\n                },\n                success: function success(rows) {\n                    self.attrList = rows;\n\n                    if (callback && typeof callback == \'function\') {\n                        callback();\n                    }\n                },\n                error: function error() {\n                    self.attrList = [];\n                }\n            });\n        },\n        goodsIn: function goodsIn() {\n            var self = this;\n            self.$validate(true);\n            if (self.$v.invalid) {\n                return;\n            }\n            if (self.loading.in) {\n                return;\n            }\n            self.loading.in = !self.loading.in;\n\n            self.model.attr = $(self.$el).find(\'#productAttr\').val();\n            $.ajax({\n                url: _api2.default.goodsIn,\n                type: \'post\',\n                data: (0, _stringify2.default)(self.model),\n                success: function success(resp) {\n                    self.alert({\n                        show: true,\n                        msg: \'入库成功\',\n                        type: \'success\'\n                    });\n                    self.reset(true);\n                },\n                error: function error(resp) {\n                    self.alert({\n                        show: true,\n                        msg: resp.responseText || \'入库失败\',\n                        type: \'error\'\n                    });\n                }\n            }).always(function () {\n                self.loading.in = !self.loading.in;\n            });\n        },\n        reset: function reset(flag) {\n            var id = flag ? this.model.id : "";\n            var name = flag ? this.model.name : "";\n            this.model = {\n                id: id,\n                name: name,\n                attr: [],\n                amount: 0,\n                priceIn: ""\n            };\n            this.$resetValidation();\n        }\n    },\n    vuex: {\n        getters: {\n            lang: function lang(state) {\n                return state.lang;\n            }\n        },\n        actions: {\n            alert: _actions2.default.alert\n        }\n    }\n});\nexports.default = GoodIn;\n// </script>\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(10), __webpack_require__(9)))\n\n/*****************\n ** WEBPACK FOOTER\n ** G:/professional/workspace/out2man/kil/~/babel-loader?{"presets":["G://professional//workspace//out2man//kil//~//babel-preset-es2015//index.js"],"plugins":[["G://professional//workspace//out2man//kil//~//babel-plugin-transform-runtime//lib//index.js"]],"cacheDirectory":true}!G:/professional/workspace/out2man/kil/~/vue-loader/lib/selector.js?type=script&index=0!./js/features/goods/in.vue\n ** module id = 247\n ** module chunks = 7\n **/\n//# sourceURL=webpack:///./js/features/goods/in.vue?G:/professional/workspace/out2man/kil/~/babel-loader?%7B%22presets%22:%5B%22G://professional//workspace//out2man//kil//~//babel-preset-es2015//index.js%22%5D,%22plugins%22:%5B%5B%22G://professional//workspace//out2man//kil//~//babel-plugin-transform-runtime//lib//index.js%22%5D%5D,%22cacheDirectory%22:true%7D!G:/professional/workspace/out2man/kil/~/vue-loader/lib/selector.js?type=script&index=0')},248:function(module,exports){eval('module.exports = "<div class=\\"panel panel-primary good-in\\"> <div class=panel-heading>商品入库</div> <div class=panel-body> <validator name=v> <div class=input-group> <span class=input-group-addon>商品名称</span> <div class=select2Div> <select id=productName style=\\"width: 100%\\" v-model=model.id v-validate:name={required:true}> </select> </div> </div> <div class=\\"input-group error-msg\\" v-if=\\"$v.name.touched && $v.name.invalid\\"> <div v-if=$v.name.required class=red-color>商品名称不能为空</div> </div> <div class=input-group> <span class=input-group-addon>商品属性</span> <div class=select2Div> <select id=productAttr style=\\"width: 100%\\"> <option v-for=\\"attr in attrList\\" :value=attr.attr>{{attr.attr}}</option> </select> </div> </div> <div class=input-group> <span class=input-group-addon>入库数量</span> <input id=productAmount type=text class=form-control placeholder=请输入入库数量 aria-describedby=productAmount v-model=model.amount v-validate:amount=\\"{required:true, posInt: true}\\" :class=\\"{\'red-border\': $v.amount && $v.amount.touched && $v.amount.invalid}\\" number> </div> <div class=\\"input-group error-msg\\" v-if=\\"$v.amount.touched && $v.amount.invalid\\"> <div v-if=$v.amount.required class=red-color>入库数量不能为空</div> <div v-if=\\"!$v.amount.required && $v.amount.posInt\\" class=red-color>入库数量只能为正整数</div> </div> <div class=input-group> <span class=input-group-addon id=productAmount>商品进价</span> <input type=text class=form-control placeholder=请输入商品进价 aria-describedby=productPriceIn v-model=model.priceIn v-validate:price=\\"{required:true, number: true}\\" :class=\\"{\'red-border\': $v.price && $v.price.touched && $v.price.invalid}\\"> </div> <div class=\\"input-group error-msg\\" v-if=\\"$v.price.touched && $v.price.invalid\\"> <div v-if=$v.price.required class=red-color>商品进价不能为空</div> <div v-if=\\"!$v.price.required && $v.price.number\\" class=red-color>商品进价只能为数字</div> </div> <div class=\\"float-right btns\\"> <button type=button class=\\"btn btn-primary\\" @click=goodsIn>入库</button> <button type=button class=\\"btn btn-danger\\" @click=reset>取消</button> </div> </validator> </div> </div>";\n\n/*****************\n ** WEBPACK FOOTER\n ** G:/professional/workspace/out2man/kil/~/vue-html-loader!G:/professional/workspace/out2man/kil/~/vue-loader/lib/selector.js?type=template&index=0!./js/features/goods/in.vue\n ** module id = 248\n ** module chunks = 7\n **/\n//# sourceURL=webpack:///./js/features/goods/in.vue?G:/professional/workspace/out2man/kil/~/vue-html-loader!G:/professional/workspace/out2man/kil/~/vue-loader/lib/selector.js?type=template&index=0')}});