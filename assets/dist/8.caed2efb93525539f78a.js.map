{"version":3,"sources":["webpack:///8.caed2efb93525539f78a.js","webpack:///./js/config/dict.js?53ae**","webpack:///./js/features/goods/out.vue","webpack:///out.vue","webpack:///./js/features/goods/out.vue?d2a5"],"names":["webpackJsonp",59,"module","exports","Object","defineProperty","value","dict","goodsMenu","select2","zh","errorLoading","inputTooLong","args","overChars","input","length","maximum","message","inputTooShort","remainingChars","minimum","loadingMore","maximumSelected","noResults","searching",82,"__webpack_require__","__vue_script__","__vue_template__","__esModule","options","template",83,"Vue","$","_interopRequireDefault","obj","default","_stringify","_stringify2","_api","_api2","_dict","_dict2","_actions","_actions2","Out","extend","name","data","model","id","attr","amount","priceOut","attrList","loading","fetch","fetchList","out","ready","self","this","$el","find","placeholder","language","lang","minimumInputLength","ajax","url","searchGood","params","term","page","dataType","delay","processResults","resp","ret","forEach","r","push","text","results","on","event","fetchCombination","minimumResultsForSearch","Infinity","$watch","changeSelect","init","watch","trigger","methods","attrCombination","good_id","success","rows","error","$route","query","decodeURIComponent","append","goodsOut","$validate","$v","invalid","val","type","alert","show","msg","reset","responseText","always","$resetValidation","vuex","getters","state","actions","call",84],"mappings":"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","file":"8.caed2efb93525539f78a.js","sourcesContent":["webpackJsonp([8],{\n\n/***/ 59:\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tvar dict = {\n\t    goodsMenu: ['text_goods_state', 'text_goods_list', 'text_goods_out', 'text_goods_in', 'text_goods_outlist', 'text_goods_inlist', 'text_goods_create'],\n\t    select2: {\n\t        \"zh\": {\n\t            errorLoading: function errorLoading() {\n\t                return '无法载入结果。';\n\t            },\n\t            inputTooLong: function inputTooLong(args) {\n\t                var overChars = args.input.length - args.maximum;\n\t\n\t                var message = '请删除' + overChars + '个字符';\n\t\n\t                return message;\n\t            },\n\t            inputTooShort: function inputTooShort(args) {\n\t                var remainingChars = args.minimum - args.input.length;\n\t\n\t                var message = '请再输入至少' + remainingChars + '个字符';\n\t\n\t                return message;\n\t            },\n\t            loadingMore: function loadingMore() {\n\t                return '载入更多结果…';\n\t            },\n\t            maximumSelected: function maximumSelected(args) {\n\t                var message = '最多只能选择' + args.maximum + '个项目';\n\t\n\t                return message;\n\t            },\n\t            noResults: function noResults() {\n\t                return '未找到结果';\n\t            },\n\t            searching: function searching() {\n\t                return '搜索中…';\n\t            }\n\t        }\n\t    }\n\t};\n\t\n\texports.default = dict;\n\n/***/ },\n\n/***/ 82:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__vue_script__ = __webpack_require__(83)\n\t__vue_template__ = __webpack_require__(84)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ },\n\n/***/ 83:\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(Vue, $) {'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _stringify = __webpack_require__(72);\n\t\n\tvar _stringify2 = _interopRequireDefault(_stringify);\n\t\n\tvar _api = __webpack_require__(55);\n\t\n\tvar _api2 = _interopRequireDefault(_api);\n\t\n\tvar _dict = __webpack_require__(59);\n\t\n\tvar _dict2 = _interopRequireDefault(_dict);\n\t\n\tvar _actions = __webpack_require__(52);\n\t\n\tvar _actions2 = _interopRequireDefault(_actions);\n\t\n\t__webpack_require__(15);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t// <template>\n\t//     <div class=\"panel panel-primary good-in\">\n\t//         <div class=\"panel-heading\">商品出库</div>\n\t//         <div class=\"panel-body\" v-show=\"!loading.fetch\">\n\t//             <validator name=\"v\">\n\t//                 <div class=\"input-group\">\n\t//                     <span class=\"input-group-addon\">商品名称</span>\n\t//                     <div class=\"select2Div\">\n\t//                         <select id=\"productName\" style=\"width: 100%\" v-model=\"model.id\" v-validate:name=\"{required:true}\">\n\t//                         </select>\n\t//                     </div>\n\t//                 </div>\n\t//                 <div class=\"input-group error-msg\" v-if=\"$v.name.touched && $v.name.invalid\">\n\t//                     <div v-if=\"$v.name.required\" class=\"red-color\">商品名称不能为空</div>\n\t//                 </div>\n\t//                 <div class=\"input-group\">\n\t//                     <span class=\"input-group-addon\">商品属性</span>\n\t//                     <div class=\"select2Div\">\n\t//                         <select id=\"productAttr\" style=\"width: 100%\" v-model=\"model.attr\">\n\t//                             <option v-for=\"attr in attrList\" :value=\"attr.attr\">{{attr.attr | remove-whitespace}}</option>\n\t//                         </select>\n\t//                     </div>\n\t//                 </div>\n\t//                 <div class=\"input-group\">\n\t//                     <span class=\"input-group-addon\">出库数量</span>\n\t//                     <input id=\"productAmount\" type=\"text\" class=\"form-control\" placeholder=\"请输入出库数量\" aria-describedby=\"productAmount\" v-model=\"model.amount\" v-validate:amount=\"{required:true, posInt: true}\" :class=\"{'red-border': $v.amount && $v.amount.touched && $v.amount.invalid}\" number>\n\t//                 </div>\n\t//                 <div class=\"input-group error-msg\" v-if=\"$v.amount.touched && $v.amount.invalid\">\n\t//                     <div v-if=\"$v.amount.required\" class=\"red-color\">出库数量不能为空</div>\n\t//                     <div v-if=\"!$v.amount.required && $v.amount.posInt\" class=\"red-color\">出库数量只能为正整数</div>\n\t//                 </div>\n\t//                 <div class=\"input-group\">\n\t//                     <span class=\"input-group-addon\" id=\"productAmount\">出售总价</span>\n\t//                     <input type=\"text\" class=\"form-control\" placeholder=\"请输入商品进价\" aria-describedby=\"productPriceIn\" v-model=\"model.priceOut\" v-validate:price=\"{required:true, number: true}\" :class=\"{'red-border': $v.price && $v.price.touched && $v.price.invalid}\">\n\t//                 </div>\n\t//                 <div class=\"input-group error-msg\" v-if=\"$v.price.touched && $v.price.invalid\">\n\t//                     <div v-if=\"$v.price.required\" class=\"red-color\">出售总价不能为空</div>\n\t//                     <div v-if=\"!$v.price.required && $v.price.number\" class=\"red-color\">出售总价只能为数字</div>\n\t//                 </div>\n\t//                 <div class=\"float-right btns\">\n\t//                     <button type=\"button\" class=\"btn btn-primary\" @click=\"goodsOut\">出库</button>\n\t//                     <button type=\"button\" class=\"btn btn-danger\" @click=\"reset\">取消</button>\n\t//                 </div>\n\t//             </validator>\n\t//         </div>\n\t//         <div class=\"empty\" v-show=\"loading.fetch\">\n\t//             <div class=\"msg\">正在加载商品详情</div>\n\t//         </div>\n\t//     </div>\n\t// </template>\n\t// <script>\n\t\n\t\n\tvar Out = Vue.extend({\n\t    name: 'out',\n\t    data: function data() {\n\t        return {\n\t            model: {\n\t                id: \"\",\n\t                name: \"\",\n\t                attr: \"\",\n\t                amount: 0,\n\t                priceOut: \"\"\n\t            },\n\t            attrList: [],\n\t            loading: {\n\t                fetch: false,\n\t                fetchList: false,\n\t                out: false\n\t            }\n\t        };\n\t    },\n\t    ready: function ready() {\n\t        var self = this;\n\t        $(this.$el).find('#productName').select2({\n\t            placeholder: \"请输入商品名称（必填）\",\n\t            language: _dict2.default.select2[this.lang],\n\t            minimumInputLength: 1,\n\t            ajax: {\n\t                url: _api2.default.searchGood,\n\t                data: function data(params) {\n\t                    return {\n\t                        name: params.term,\n\t                        page: params.page\n\t                    };\n\t                },\n\t\n\t                dataType: 'json',\n\t                delay: 700,\n\t                processResults: function processResults(resp, params) {\n\t                    var ret = [];\n\t                    resp.forEach(function (r) {\n\t                        ret.push({\n\t                            id: r.id,\n\t                            text: r.name\n\t                        });\n\t                    });\n\t\n\t                    return {\n\t                        results: ret\n\t                    };\n\t                }\n\t            }\n\t        }).on('select2:select', function (event) {\n\t            var data = event.params.data;\n\t            if (data) {\n\t                self.model.id = data.id;\n\t                self.model.name = data.text;\n\t                self.fetchCombination();\n\t            }\n\t        });\n\t        $(this.$el).find('#productAttr').select2({\n\t            placeholder: \"请选择商品属性\",\n\t            language: _dict2.default.select2[this.lang],\n\t            minimumResultsForSearch: Infinity\n\t        });\n\t\n\t        this.$watch('model.id', this.changeSelect);\n\t        this.init();\n\t    },\n\t\n\t    watch: {\n\t        attrList: function attrList() {\n\t            $(this.$el).find('#productAttr').trigger('change');\n\t        }\n\t    },\n\t    methods: {\n\t        fetchCombination: function fetchCombination() {\n\t            var self = this;\n\t            $.ajax({\n\t                url: _api2.default.attrCombination,\n\t                data: {\n\t                    good_id: this.model.id\n\t                },\n\t                success: function success(rows) {\n\t                    self.attrList = rows;\n\t                },\n\t                error: function error() {\n\t                    self.attrList = [];\n\t                }\n\t            });\n\t        },\n\t        init: function init() {\n\t            var id = this.$route.query.id;\n\t            var name = this.$route.query.name;\n\t\n\t            if (id && name) {\n\t                this.model.id = id;\n\t                this.model.name = decodeURIComponent(name);\n\t                $(this.$el).find('#productName').append('<option value=\"' + this.model.id + '\">' + this.model.name + '</option>');\n\t                this.fetchCombination();\n\t            }\n\t            var attr = this.$route.query.attr;\n\t            if (attr) {\n\t                this.model.attr = decodeURIComponent(attr);\n\t            }\n\t        },\n\t        changeSelect: function changeSelect() {\n\t            $(this.$el).find('#productName').trigger('change');\n\t        },\n\t        goodsOut: function goodsOut() {\n\t            var self = this;\n\t            self.$validate(true);\n\t            if (self.$v.invalid) {\n\t                return;\n\t            }\n\t            if (self.loading.out) {\n\t                return;\n\t            }\n\t            self.loading.out = !self.loading.out;\n\t            self.model.attr = $(self.$el).find('#productAttr').val();\n\t            $.ajax({\n\t                url: _api2.default.goodsOut,\n\t                type: 'post',\n\t                data: (0, _stringify2.default)(self.model),\n\t                success: function success(resp) {\n\t                    self.alert({\n\t                        show: true,\n\t                        msg: '出库成功',\n\t                        type: 'success'\n\t                    });\n\t                    self.reset();\n\t                },\n\t                error: function error(resp) {\n\t                    self.alert({\n\t                        show: true,\n\t                        msg: resp.responseText || '出库失败',\n\t                        type: 'error'\n\t                    });\n\t                }\n\t            }).always(function () {\n\t                self.loading.out = !self.loading.out;\n\t            });\n\t        },\n\t        reset: function reset() {\n\t            this.model = {\n\t                id: \"\",\n\t                name: \"\",\n\t                attr: \"\",\n\t                amount: 0,\n\t                priceOut: \"\"\n\t            };\n\t            this.attrList = [];\n\t            this.$resetValidation();\n\t        }\n\t    },\n\t    vuex: {\n\t        getters: {\n\t            lang: function lang(state) {\n\t                return state.lang;\n\t            }\n\t        },\n\t        actions: {\n\t            alert: _actions2.default.alert\n\t        }\n\t    }\n\t});\n\texports.default = Out;\n\t// </script>\n\t/* generated by vue-loader */\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(9), __webpack_require__(8)))\n\n/***/ },\n\n/***/ 84:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"panel panel-primary good-in\\\"> <div class=panel-heading>商品出库</div> <div class=panel-body v-show=!loading.fetch> <validator name=v> <div class=input-group> <span class=input-group-addon>商品名称</span> <div class=select2Div> <select id=productName style=\\\"width: 100%\\\" v-model=model.id v-validate:name={required:true}> </select> </div> </div> <div class=\\\"input-group error-msg\\\" v-if=\\\"$v.name.touched && $v.name.invalid\\\"> <div v-if=$v.name.required class=red-color>商品名称不能为空</div> </div> <div class=input-group> <span class=input-group-addon>商品属性</span> <div class=select2Div> <select id=productAttr style=\\\"width: 100%\\\" v-model=model.attr> <option v-for=\\\"attr in attrList\\\" :value=attr.attr>{{attr.attr | remove-whitespace}}</option> </select> </div> </div> <div class=input-group> <span class=input-group-addon>出库数量</span> <input id=productAmount type=text class=form-control placeholder=请输入出库数量 aria-describedby=productAmount v-model=model.amount v-validate:amount=\\\"{required:true, posInt: true}\\\" :class=\\\"{'red-border': $v.amount && $v.amount.touched && $v.amount.invalid}\\\" number> </div> <div class=\\\"input-group error-msg\\\" v-if=\\\"$v.amount.touched && $v.amount.invalid\\\"> <div v-if=$v.amount.required class=red-color>出库数量不能为空</div> <div v-if=\\\"!$v.amount.required && $v.amount.posInt\\\" class=red-color>出库数量只能为正整数</div> </div> <div class=input-group> <span class=input-group-addon id=productAmount>出售总价</span> <input type=text class=form-control placeholder=请输入商品进价 aria-describedby=productPriceIn v-model=model.priceOut v-validate:price=\\\"{required:true, number: true}\\\" :class=\\\"{'red-border': $v.price && $v.price.touched && $v.price.invalid}\\\"> </div> <div class=\\\"input-group error-msg\\\" v-if=\\\"$v.price.touched && $v.price.invalid\\\"> <div v-if=$v.price.required class=red-color>出售总价不能为空</div> <div v-if=\\\"!$v.price.required && $v.price.number\\\" class=red-color>出售总价只能为数字</div> </div> <div class=\\\"float-right btns\\\"> <button type=button class=\\\"btn btn-primary\\\" @click=goodsOut>出库</button> <button type=button class=\\\"btn btn-danger\\\" @click=reset>取消</button> </div> </validator> </div> <div class=empty v-show=loading.fetch> <div class=msg>正在加载商品详情</div> </div> </div>\";\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** 8.caed2efb93525539f78a.js\n **/","const dict = {\n    goodsMenu: ['text_goods_state', 'text_goods_list', 'text_goods_out', 'text_goods_in', 'text_goods_outlist', 'text_goods_inlist', 'text_goods_create'],\n    select2: {\n        \"zh\": {\n            errorLoading: function() {\n                return '无法载入结果。';\n            },\n            inputTooLong: function(args) {\n                var overChars = args.input.length - args.maximum;\n\n                var message = '请删除' + overChars + '个字符';\n\n                return message;\n            },\n            inputTooShort: function(args) {\n                var remainingChars = args.minimum - args.input.length;\n\n                var message = '请再输入至少' + remainingChars + '个字符';\n\n                return message;\n            },\n            loadingMore: function() {\n                return '载入更多结果…';\n            },\n            maximumSelected: function(args) {\n                var message = '最多只能选择' + args.maximum + '个项目';\n\n                return message;\n            },\n            noResults: function() {\n                return '未找到结果';\n            },\n            searching: function() {\n                return '搜索中…';\n            }\n        }\n    }\n}\n\nexport default dict;\n\n\n/** WEBPACK FOOTER **\n ** ./js/config/dict.js\n **/","var __vue_script__, __vue_template__\n__vue_script__ = require(\"!!babel?{\\\"presets\\\":[\\\"/Users/ding/Documents/out2man/kil/node_modules/babel-preset-es2015/index.js\\\"],\\\"plugins\\\":[[\\\"/Users/ding/Documents/out2man/kil/node_modules/babel-plugin-transform-runtime/lib/index.js\\\"]],\\\"cacheDirectory\\\":true}!./../../../../../kil/node_modules/vue-loader/lib/selector.js?type=script&index=0!./out.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../../../../kil/node_modules/vue-loader/lib/selector.js?type=template&index=0!./out.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/features/goods/out.vue\n ** module id = 82\n ** module chunks = 8\n **/","<template>\n    <div class=\"panel panel-primary good-in\">\n        <div class=\"panel-heading\">商品出库</div>\n        <div class=\"panel-body\" v-show=\"!loading.fetch\">\n            <validator name=\"v\">\n                <div class=\"input-group\">\n                    <span class=\"input-group-addon\">商品名称</span>\n                    <div class=\"select2Div\">\n                        <select id=\"productName\" style=\"width: 100%\" v-model=\"model.id\" v-validate:name=\"{required:true}\">\n                        </select>\n                    </div>\n                </div>\n                <div class=\"input-group error-msg\" v-if=\"$v.name.touched && $v.name.invalid\">\n                    <div v-if=\"$v.name.required\" class=\"red-color\">商品名称不能为空</div>\n                </div>\n                <div class=\"input-group\">\n                    <span class=\"input-group-addon\">商品属性</span>\n                    <div class=\"select2Div\">\n                        <select id=\"productAttr\" style=\"width: 100%\" v-model=\"model.attr\">\n                            <option v-for=\"attr in attrList\" :value=\"attr.attr\">{{attr.attr | remove-whitespace}}</option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"input-group\">\n                    <span class=\"input-group-addon\">出库数量</span>\n                    <input id=\"productAmount\" type=\"text\" class=\"form-control\" placeholder=\"请输入出库数量\" aria-describedby=\"productAmount\" v-model=\"model.amount\" v-validate:amount=\"{required:true, posInt: true}\" :class=\"{'red-border': $v.amount && $v.amount.touched && $v.amount.invalid}\" number>\n                </div>\n                <div class=\"input-group error-msg\" v-if=\"$v.amount.touched && $v.amount.invalid\">\n                    <div v-if=\"$v.amount.required\" class=\"red-color\">出库数量不能为空</div>\n                    <div v-if=\"!$v.amount.required && $v.amount.posInt\" class=\"red-color\">出库数量只能为正整数</div>\n                </div>\n                <div class=\"input-group\">\n                    <span class=\"input-group-addon\" id=\"productAmount\">出售总价</span>\n                    <input type=\"text\" class=\"form-control\" placeholder=\"请输入商品进价\" aria-describedby=\"productPriceIn\" v-model=\"model.priceOut\" v-validate:price=\"{required:true, number: true}\" :class=\"{'red-border': $v.price && $v.price.touched && $v.price.invalid}\">\n                </div>\n                <div class=\"input-group error-msg\" v-if=\"$v.price.touched && $v.price.invalid\">\n                    <div v-if=\"$v.price.required\" class=\"red-color\">出售总价不能为空</div>\n                    <div v-if=\"!$v.price.required && $v.price.number\" class=\"red-color\">出售总价只能为数字</div>\n                </div>\n                <div class=\"float-right btns\">\n                    <button type=\"button\" class=\"btn btn-primary\" @click=\"goodsOut\">出库</button>\n                    <button type=\"button\" class=\"btn btn-danger\" @click=\"reset\">取消</button>\n                </div>\n            </validator>\n        </div>\n        <div class=\"empty\" v-show=\"loading.fetch\">\n            <div class=\"msg\">正在加载商品详情</div>\n        </div>\n    </div>\n</template>\n<script>\nimport API from '../../config/api';\nimport DICT from '../../config/dict';\nimport actions from '../../vuex/actions';\nimport 'select2';\n\nvar Out = Vue.extend({\n    name: 'out',\n    data() {\n        return {\n            model: {\n                id: \"\",\n                name: \"\",\n                attr: \"\",\n                amount: 0,\n                priceOut: \"\"\n            },\n            attrList: [],\n            loading: {\n                fetch: false,\n                fetchList: false,\n                out: false\n            }\n        }\n    },\n    ready() {\n        var self = this;\n        $(this.$el).find('#productName').select2({\n            placeholder: \"请输入商品名称（必填）\",\n            language: DICT.select2[this.lang],\n            minimumInputLength: 1,\n            ajax: {\n                url: API.searchGood,\n                data(params) {\n                    return {\n                        name: params.term,\n                        page: params.page\n                    };\n                },\n                dataType: 'json',\n                delay: 700,\n                processResults: function(resp, params) {\n                    var ret = [];\n                    resp.forEach((r) => {\n                        ret.push({\n                            id: r.id,\n                            text: r.name\n                        })\n                    })\n\n                    return {\n                        results: ret\n                    };\n                }\n            }\n        }).on('select2:select', (event) => {\n            var data = event.params.data;\n            if (data) {\n                self.model.id = data.id;\n                self.model.name = data.text;\n                self.fetchCombination();\n            }\n        })\n        $(this.$el).find('#productAttr').select2({\n            placeholder: \"请选择商品属性\",\n            language: DICT.select2[this.lang],\n            minimumResultsForSearch: Infinity\n        })\n\n        this.$watch('model.id', this.changeSelect);\n        this.init();\n    },\n    watch: {\n        attrList() {\n            $(this.$el).find('#productAttr').trigger('change');\n        }\n    },\n    methods: {\n        fetchCombination() {\n            var self = this;\n            $.ajax({\n                url: API.attrCombination,\n                data: {\n                    good_id: this.model.id\n                },\n                success(rows) {\n                    self.attrList = rows;\n                },\n                error() {\n                    self.attrList = [];\n                }\n            })\n        },\n        init() {\n            var id = this.$route.query.id;\n            var name = this.$route.query.name;\n\n            if (id && name) {\n                this.model.id = id;\n                this.model.name = decodeURIComponent(name);\n                $(this.$el).find('#productName').append('<option value=\"' + this.model.id + '\">' + this.model.name + '</option>');\n                this.fetchCombination();\n            }\n            var attr = this.$route.query.attr;\n            if (attr) {\n                this.model.attr = decodeURIComponent(attr);\n            }\n        },\n        changeSelect() {\n            $(this.$el).find('#productName').trigger('change');\n        },\n        goodsOut() {\n            var self = this;\n            self.$validate(true);\n            if (self.$v.invalid) {\n                return;\n            }\n            if (self.loading.out) {\n                return;\n            }\n            self.loading.out = !self.loading.out;\n            self.model.attr = $(self.$el).find('#productAttr').val();\n            $.ajax({\n                url: API.goodsOut,\n                type: 'post',\n                data: JSON.stringify(self.model),\n                success(resp) {\n                    self.alert({\n                        show: true,\n                        msg: '出库成功',\n                        type: 'success'\n                    });\n                    self.reset();\n                },\n                error(resp) {\n                    self.alert({\n                        show: true,\n                        msg: resp.responseText || '出库失败',\n                        type: 'error'\n                    })\n                }\n            }).always(() => {\n                self.loading.out = !self.loading.out;\n            })\n        },\n        reset() {\n            this.model = {\n                id: \"\",\n                name: \"\",\n                attr: \"\",\n                amount: 0,\n                priceOut: \"\"\n            };\n            this.attrList = [];\n            this.$resetValidation();\n        }\n    },\n    vuex: {\n        getters: {\n            lang: state => state.lang\n        },\n        actions: {\n            alert: actions.alert\n        }\n    }\n})\nexport default Out;\n</script>\n\n\n/** WEBPACK FOOTER **\n ** out.vue?736b985c\n **/","module.exports = \"<div class=\\\"panel panel-primary good-in\\\"> <div class=panel-heading>商品出库</div> <div class=panel-body v-show=!loading.fetch> <validator name=v> <div class=input-group> <span class=input-group-addon>商品名称</span> <div class=select2Div> <select id=productName style=\\\"width: 100%\\\" v-model=model.id v-validate:name={required:true}> </select> </div> </div> <div class=\\\"input-group error-msg\\\" v-if=\\\"$v.name.touched && $v.name.invalid\\\"> <div v-if=$v.name.required class=red-color>商品名称不能为空</div> </div> <div class=input-group> <span class=input-group-addon>商品属性</span> <div class=select2Div> <select id=productAttr style=\\\"width: 100%\\\" v-model=model.attr> <option v-for=\\\"attr in attrList\\\" :value=attr.attr>{{attr.attr | remove-whitespace}}</option> </select> </div> </div> <div class=input-group> <span class=input-group-addon>出库数量</span> <input id=productAmount type=text class=form-control placeholder=请输入出库数量 aria-describedby=productAmount v-model=model.amount v-validate:amount=\\\"{required:true, posInt: true}\\\" :class=\\\"{'red-border': $v.amount && $v.amount.touched && $v.amount.invalid}\\\" number> </div> <div class=\\\"input-group error-msg\\\" v-if=\\\"$v.amount.touched && $v.amount.invalid\\\"> <div v-if=$v.amount.required class=red-color>出库数量不能为空</div> <div v-if=\\\"!$v.amount.required && $v.amount.posInt\\\" class=red-color>出库数量只能为正整数</div> </div> <div class=input-group> <span class=input-group-addon id=productAmount>出售总价</span> <input type=text class=form-control placeholder=请输入商品进价 aria-describedby=productPriceIn v-model=model.priceOut v-validate:price=\\\"{required:true, number: true}\\\" :class=\\\"{'red-border': $v.price && $v.price.touched && $v.price.invalid}\\\"> </div> <div class=\\\"input-group error-msg\\\" v-if=\\\"$v.price.touched && $v.price.invalid\\\"> <div v-if=$v.price.required class=red-color>出售总价不能为空</div> <div v-if=\\\"!$v.price.required && $v.price.number\\\" class=red-color>出售总价只能为数字</div> </div> <div class=\\\"float-right btns\\\"> <button type=button class=\\\"btn btn-primary\\\" @click=goodsOut>出库</button> <button type=button class=\\\"btn btn-danger\\\" @click=reset>取消</button> </div> </validator> </div> <div class=empty v-show=loading.fetch> <div class=msg>正在加载商品详情</div> </div> </div>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** /Users/ding/Documents/out2man/kil/~/vue-html-loader!/Users/ding/Documents/out2man/kil/~/vue-loader/lib/selector.js?type=template&index=0!./js/features/goods/out.vue\n ** module id = 84\n ** module chunks = 8\n **/"],"sourceRoot":""}