webpackJsonp([11],{261:function(module,exports,__webpack_require__){eval('var __vue_script__, __vue_template__\n__vue_script__ = __webpack_require__(262)\n__vue_template__ = __webpack_require__(263)\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === "function" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/features/goods/detail.vue\n ** module id = 261\n ** module chunks = 11\n **/\n//# sourceURL=webpack:///./js/features/goods/detail.vue?')},262:function(module,exports,__webpack_require__){eval('/* WEBPACK VAR INJECTION */(function(Vue, $) {\'use strict\';\n\nObject.defineProperty(exports, "__esModule", {\n    value: true\n});\n\nvar _stringify = __webpack_require__(240);\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _api = __webpack_require__(64);\n\nvar _api2 = _interopRequireDefault(_api);\n\nvar _actions = __webpack_require__(61);\n\nvar _actions2 = _interopRequireDefault(_actions);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// <template>\n//     <div class="panel panel-primary good-detail">\n//         <div class="panel-heading">{{good.name}}</div>\n//         <div class="attList">\n//             <table class="table">\n//                 <thead>\n//                     <tr>\n//                         <th>属性列表<span class="add-attr" data-container=".good-detail" data-toggle="popover" data-placement="bottom">+</span></th>\n//                     </tr>\n//                 </thead>\n//                 <tbody>\n//                     <tr>\n//                         <td>\n//                             <span v-for="attr in attrlist" class="attr">{{attr.attr}}</span>\n//                         </td>\n//                     </tr>\n//                 </tbody>\n//             </table>\n//         </div>\n//         <table class="table" v-if="!loading.fetch">\n//             <thead>\n//                 <tr>\n//                     <th>库存列表</th>\n//                     <th>库存数量</th>\n//                     <th>操作</th>\n//                     <th>趋势</th>\n//                 </tr>\n//             </thead>\n//             <tbody>\n//                 <tr class="item">\n//                     <td>所有</td>\n//                     <td>{{good.total}}</td>\n//                     <td>\n//                     </td>\n//                     <td>\n//                         <a href="javascript:void(0)" v-link="{path: \'/goods/analysis\'}">趋势</a>\n//                     </td>\n//                 </tr>\n//                 <tr class="item" v-for="g in good.list">\n//                     <td>{{g.attr | remove-whitespace}}</td>\n//                     <td>{{g.count}}</td>\n//                     <td>\n//                         <a href="javascript:void(0)" v-link="{path: \'/goods/in\', query: {id: good.id, name: good.name, attr: g.attr} }">入库</a>\n//                         <a href="javascript:void(0)" v-link="{path: \'/goods/out\', query: {id: good.id, name: good.name, attr: g.attr} }">出库</a>\n//                     </td>\n//                     <td>\n//                         <a href="javascript:void(0)" v-link="{path: \'/goods/analysis\'}">趋势</a>\n//                     </td>\n//                 </tr>\n//             </tbody>\n//         </table>\n//         <div v-if="loading.fetch">\n//             <div class="loading audio-wave"></div>\n//         </div>\n// </template>\n// <script>\n\n\nvar GoodDetail = Vue.extend({\n    name: \'goodList\',\n    data: function data() {\n        return {\n            attrlist: [],\n            good: {\n                name: "",\n                list: []\n            },\n            loading: {\n                fetch: false,\n                add: false\n            }\n        };\n    },\n    ready: function ready() {\n        this.fetch(true);\n        this.fetchAttrList();\n\n        $(this.$el).on(\'click\', \'.save\', this.addAttr);\n        $(\'.add-attr\').popover({\n            content: function content() {\n                return \'<input type="text" placeholder="请输入属性名称" class="attrName"/><button class="btn-primary save">保存</button>\';\n            },\n\n            html: true\n        });\n    },\n\n    methods: {\n        addAttr: function addAttr() {\n            var self = this;\n            var attr = $(this.$el).find(\'.attrName\').val();\n            if (!attr || !attr.trim()) {\n                return;\n            }\n\n            if (self.loading.add) {\n                return;\n            }\n\n            self.loading.add = !self.loading.add;\n            $.ajax({\n                url: _api2.default.addAttr,\n                type: \'post\',\n                data: (0, _stringify2.default)({\n                    attr: attr,\n                    goods_id: this.good.id\n                }),\n                success: function success(resp) {\n                    self.alert({\n                        show: true,\n                        msg: \'添加成功\',\n                        type: \'success\'\n                    });\n                    self.attrlist.push({\n                        attr: attr\n                    });\n                    $(self.$el).find(\'.attrName\').val(\'\');\n                    $(\'.add-attr\').popover(\'hide\');\n                },\n                error: function error(resp) {\n                    self.alert({\n                        show: true,\n                        msg: resp.responseText || \'添加商品属性失败\',\n                        type: \'error\'\n                    });\n                }\n            }).always(function () {\n                self.loading.add = !self.loading.add;\n            });\n        },\n        fetch: function fetch(reset) {\n            var self = this;\n\n            if (self.loading.fetch) {\n                return;\n            }\n            self.loading.fetch = !self.loading.fetch;\n\n            $.ajax({\n                url: _api2.default.goodsDetail,\n                data: {\n                    id: this.$route.params.id\n                },\n                success: function success(resp) {\n                    self.good = resp;\n                },\n                error: function error(resp) {\n                    self.alert({\n                        show: true,\n                        msg: \'获取商品详情失败\',\n                        type: \'error\'\n                    });\n                }\n            }).always(function () {\n                self.loading.fetch = !self.loading.fetch;\n            });\n        },\n        fetchAttrList: function fetchAttrList(callback) {\n            var self = this;\n            $.ajax({\n                url: _api2.default.goodsAttrs,\n                data: {\n                    good_id: this.$route.params.id\n                },\n                success: function success(rows) {\n                    self.attrlist = rows;\n\n                    if (callback && typeof callback == \'function\') {\n                        callback();\n                    }\n                },\n                error: function error() {\n                    self.attrlist = [];\n                }\n            });\n        }\n    },\n    vuex: {\n        actions: {\n            alert: _actions2.default.alert\n        }\n    }\n});\nexports.default = GoodDetail;\n// </script>\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(10), __webpack_require__(9)))\n\n/*****************\n ** WEBPACK FOOTER\n ** G:/professional/workspace/out2man/kil/~/babel-loader?{"presets":["G://professional//workspace//out2man//kil//~//babel-preset-es2015//index.js"],"plugins":[["G://professional//workspace//out2man//kil//~//babel-plugin-transform-runtime//lib//index.js"]],"cacheDirectory":true}!G:/professional/workspace/out2man/kil/~/vue-loader/lib/selector.js?type=script&index=0!./js/features/goods/detail.vue\n ** module id = 262\n ** module chunks = 11\n **/\n//# sourceURL=webpack:///./js/features/goods/detail.vue?G:/professional/workspace/out2man/kil/~/babel-loader?%7B%22presets%22:%5B%22G://professional//workspace//out2man//kil//~//babel-preset-es2015//index.js%22%5D,%22plugins%22:%5B%5B%22G://professional//workspace//out2man//kil//~//babel-plugin-transform-runtime//lib//index.js%22%5D%5D,%22cacheDirectory%22:true%7D!G:/professional/workspace/out2man/kil/~/vue-loader/lib/selector.js?type=script&index=0')},263:function(module,exports){eval('module.exports = "<div class=\\"panel panel-primary good-detail\\"> <div class=panel-heading>{{good.name}}</div> <div class=attList> <table class=table> <thead> <tr> <th>属性列表<span class=add-attr data-container=.good-detail data-toggle=popover data-placement=bottom>+</span></th> </tr> </thead> <tbody> <tr> <td> <span v-for=\\"attr in attrlist\\" class=attr>{{attr.attr}}</span> </td> </tr> </tbody> </table> </div> <table class=table v-if=!loading.fetch> <thead> <tr> <th>库存列表</th> <th>库存数量</th> <th>操作</th> <th>趋势</th> </tr> </thead> <tbody> <tr class=item> <td>所有</td> <td>{{good.total}}</td> <td> </td> <td> <a href=javascript:void(0) v-link=\\"{path: \'/goods/analysis\'}\\">趋势</a> </td> </tr> <tr class=item v-for=\\"g in good.list\\"> <td>{{g.attr | remove-whitespace}}</td> <td>{{g.count}}</td> <td> <a href=javascript:void(0) v-link=\\"{path: \'/goods/in\', query: {id: good.id, name: good.name, attr: g.attr} }\\">入库</a> <a href=javascript:void(0) v-link=\\"{path: \'/goods/out\', query: {id: good.id, name: good.name, attr: g.attr} }\\">出库</a> </td> <td> <a href=javascript:void(0) v-link=\\"{path: \'/goods/analysis\'}\\">趋势</a> </td> </tr> </tbody> </table> <div v-if=loading.fetch> <div class=\\"loading audio-wave\\"></div> </div> </div>";\n\n/*****************\n ** WEBPACK FOOTER\n ** G:/professional/workspace/out2man/kil/~/vue-html-loader!G:/professional/workspace/out2man/kil/~/vue-loader/lib/selector.js?type=template&index=0!./js/features/goods/detail.vue\n ** module id = 263\n ** module chunks = 11\n **/\n//# sourceURL=webpack:///./js/features/goods/detail.vue?G:/professional/workspace/out2man/kil/~/vue-html-loader!G:/professional/workspace/out2man/kil/~/vue-loader/lib/selector.js?type=template&index=0')}});